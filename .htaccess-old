# School Management System - Apache Configuration

# Enable Rewrite Engine
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    
    # Redirect to login if not authenticated (optional)
    # RewriteCond %{REQUEST_URI} !^/auth/login\.php$
    # RewriteCond %{HTTP_COOKIE} !PHPSESSID
    # RewriteRule ^(.*)$ /auth/login.php [R=302,L]
</IfModule>

# Security Headers
<IfModule mod_headers.c>
    # Prevent clickjacking
    Header set X-Frame-Options "SAMEORIGIN"
    
    # XSS Protection
    Header set X-XSS-Protection "1; mode=block"
    
    # Prevent MIME type sniffing
    Header set X-Content-Type-Options "nosniff"
    
    # Referrer Policy
    Header set Referrer-Policy "strict-origin-when-cross-origin"
    
    # Remove server signature
    Header unset Server
    Header unset X-Powered-By
</IfModule>

# Disable directory browsing
Options -Indexes

# Protect sensitive files
<FilesMatch "\.(sql|md|log|ini)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Protect config files
<FilesMatch "^(connection|config)\.php$">
    Order allow,deny
    Deny from all
</FilesMatch>

# PHP Security Settings
<IfModule mod_php7.c>
    php_flag display_errors Off
    php_flag log_errors On
    php_value error_log error.log
</IfModule>

# Default charset
AddDefaultCharset UTF-8

# File upload limits (adjust as needed)
php_value upload_max_filesize 10M
php_value post_max_size 10M

# Session security
php_value session.cookie_httponly 1
php_value session.cookie_secure 0
php_value session.use_only_cookies 1

# Error Pages (optional)
# ErrorDocument 404 /error.php?code=404
# ErrorDocument 500 /error.php?code=500
# ErrorDocument 403 /error.php?code=403
